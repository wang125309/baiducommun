include ./lib/header.jade
title ä»»åŠ¡è¯¦æƒ…
link(href="/static/public/css/taskInfo.css",rel="stylesheet",type="text/css")
script(src="/static/public/js/taskInfo.min.js",language="javascript")
body(ng-controller="TaskInfoCtrl",ng-cloak)
    section#header(ng-show="submitView==false")
        div.check_tab.clearfix(ng-if="(commun_count>1&&task.data.type==3)||(commun_count>1&&task.data.type==4)")
            //div.first(class="{{tab1_active}}",ng-click="showOther()") {{ tab1 }}
            //div.second(class="{{tab2_active}}",ng-click="showOther()") {{ tab2 }}
            //div.more(ng-if="commun_count > 2")
            div.more-menu(ng-repeat="i in tab track by $index")
                div.commun_names.active(ng-if="active==i.num",ng-click="show_other( i.num )") 
                    div.name(ng-if="i.rel==1") 
                        span.tuan å›¢ 
                        span.name {{ i.name }}
                        
                    div.name(ng-if="i.rel!=1") {{ i.name }}
                div.commun_names(ng-if="active!=i.num",ng-click="show_other( i.num )")
                    div.name(ng-if="i.rel==1") 
                        span.tuan å›¢ 
                        span.name {{ i.name }}
                        
                    div.name(ng-if="i.rel!=1") {{ i.name }}
        div.right-coner-div=""
        div.right-coner(ng-if="taskState=='å·²é¢†å–'")
            div.stamp(style='background:url("/static/public/image/already-receive.png")')
        div.right-coner(ng-if="taskState=='å·²æäº¤'")
            div.stamp(style='background:url("/static/public/image/already-submit.png")')
        div.right-coner(ng-if="taskState=='å·²é©³å›'")
            div.stamp(style='background:url("/static/public/image/already-confuse.png")')
        div.right-coner(ng-if="taskState=='å·²è¯„å¥–'")
            div.stamp(src='/static/public/image/already-prize.png')
            div.stamp(style='background:url("/static/public/image/already-prize.png")')
        div.right-coner(ng-if="taskState=='å·²è¿‡æœŸ'")
            div.stamp(style='background:url("/static/public/image/already-expire.png")')
        div.right-coner(ng-if="taskState=='å·²é€šè¿‡'")
            div.stamp(style='background:url("/static/public/image/already-pass.png")')
        div.title {{ task.data.name }}
        div.task-info.clearfix
            div.end-time {{ task.data.endDate }}
            div.line-type.clearfix(ng-if="task.data.type==1") çº¿ä¸Š
            div.line-type.clearfix(ng-if="task.data.type==3") çº¿ä¸Š
            div.line-type.clearfix(ng-if="task.data.type==2") çº¿ä¸‹
            div.line-type.clearfix(ng-if="task.data.type==4") çº¿ä¸‹
            div.type.clearfix(ng-if="task.data.type==3") ç¤¾å›¢
            div.type.clearfix(ng-if="task.data.type==4") ç¤¾å›¢
            div.type.clearfix(ng-if="task.data.type==1") ä¸ªäºº
            div.type.clearfix(ng-if="task.data.type==2") ä¸ªäºº

        div.banner
            img(ng-src="{{ task.data.resourceUrl }}",onerror="this.src='http://placehold.it/375x170'")
        div.desc(ng-bind-html="trustHtml()")
        section.price-bar
            div.right-text.clearfix(ng-click="add_fans()")
                div.hot-icon.clearfix(ng-show="like==0",style="background:url('/static/public/image/hot-up-icon.png')")=""
                div.hot-icon.clearfix(ng-show="like==1",style="background:url('/static/public/image/hot-up-icon-active.png')")=""
                div.hot-text.clearfix èµ({{ likeNum }})
    section#task(ng-if="task.data.prizeData")
        span.green=""
        span å¥–åŠ±è¯¦æƒ…
        div.prize-data
            div.prize-data-detail.clearfix(ng-repeat="p in task.data.prizeData")
                div.prize-line(ng-if="p.prizeType==1") {{ p.prizeLevel }} {{ p.prize }}
                div.prize-line(ng-if="p.prizeType==2") {{ p.prizeLevel }} {{ p.prize }}&nbsp;ç§¯åˆ†
    section.task-condition
        span.green=""
        span ä»»åŠ¡æ¡ä»¶
        div.task-text(ng-if="task.data.condition") {{ task.data.condition }}
        div.task-text(ng-if="!task.data.condition") æ­è¿å„è·¯ç¥ä»™é¬¼æ€ªğŸ˜Šï¼Œåªè¦ä½ æ•¢æ¥ï¼Œæˆ‘ä»¬å°±æ•¢ç»™ 
    section.score(ng-if="taskState=='å·²è¯„å¥–'&&show_task_prize_list")
        div.prize-icon=""
        span è·å¥–åˆ—è¡¨
        div.score-sheet
            div.score-list.clearfix(ng-repeat="m in taskPrizeList.data.list track by $index")
                div.line.clearfix
                    div.prize-icon=""
                    div.name(ng-if="m.communityName&&m.prizeScore") {{ m.communityName }}è·å¾—{{ m.prizeScore }}&nbsp;ç§¯åˆ†
                    div.name(ng-if="m.communityName&&m.prizeName") {{ m.communityName }}è·å¾—{{ m.prizeName }}
                    div.name(ng-if="m.userName&&m.prizeScore") {{ m.userName }}è·å¾—{{ m.prizeScore }}&nbsp;ç§¯åˆ†
                    div.name(ng-if="m.userName&&m.prizeName") {{ m.userName }}è·å¾—{{ m.prizeName }}&nbsp;ç§¯åˆ†
        div.show_more(ng-click="prize_show_more()",ng-show="prize_more_show==true")="æŸ¥çœ‹æ›´å¤š"
    section.score-apply.clearfix(ng-if="taskState!='å·²è¯„å¥–'&&show_scoreRanking")
        div.apply-icon=""
        span ç”³è¯·åˆ—è¡¨
        div.score-list.clearfix
            div.line.clearfix(ng-repeat="m in scoreRanking.data.list track by $index")
                div.name.clearfix(ng-if="m.communityName") {{ m.communityName }}
                div.name.clearfix(ng-if="m.userName") {{ m.userName}}
        div.show_more(ng-click="apply_show_more()",ng-show="apply_more_show==true")="æŸ¥çœ‹æ›´å¤š"

    div.placehold-footer=""
    div.bottom-bar
        button.baidu-btn.submit-task.grey(ng-show="taskState=='å·²é¢†å–'")
            span ä»»åŠ¡å·²é¢†å–ï¼Œè¯·è€å¿ƒç­‰å€™å®¡æ ¸
        button.baidu-btn.submit-task(ng-click="getTask()",ng-if="taskState=='æœªé¢†å–'")
            span é¢†å–ä»»åŠ¡
        button.baidu-btn.submit-task(ng-show="(task.data.type==1&&taskState=='å·²é€šè¿‡')||(task.data.type==3&&taskState=='å·²é€šè¿‡'&&reltype!=0)",ng-click="submitTask();")
            span {{ submitTextOnline }}
        button.baidu-btn.submit-task(ng-click="getQrcode()",ng-show="(task.data.type==4&&taskState=='å·²é€šè¿‡'&&reltype!=0&&reltype!=4)||(task.data.type==2&&taskState=='å·²é€šè¿‡')")
            span ç‚¹å‡»è·å–äºŒç»´ç 
    div(class="alert-menu base {{ alertClass }}",ng-show="alert==true")
        div.message {{ taskMessage }}
        div.know(ng-click="iknow()")
            a(href="javascript:;") æˆ‘çŸ¥é“äº†
    div.submit-task-view.base.pull-up(ng-show="submitView==true")
        div.add-file
            div.add-title æ·»åŠ æ–‡ä»¶
            div.pull-right.clear.back-link(href="javascript:;",ng-click="backTask()") è¿”å›
            form(method="post",id="form",role="form",enctype="multipart/form-data")
                div.add-area
                    div.preview(ng-repeat="i in previews",style="{{ i.image }}")
                        //div.close(ng-click="close_img(i.pos)")=""
                    div.file-add(ng-click="fileAdd()")=""   
                    input(hidden,name="taskStatusId",value="{{ taskStatusId }}")
                    input.add-image(ng-repeat="i in image_files",name="file",type="file",file-upload,id="add-image-{{ i }}")
        div.submit-btn(ng-click="form_submit()") {{ submitText }}
